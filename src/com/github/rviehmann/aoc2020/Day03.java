package com.github.rviehmann.aoc2020;

public class Day03 {

    // From: https://adventofcode.com/2020/day/3/input
    private static final String INPUT =
            "...#....#.#...##......#.#...##.\n" +
                    ".#..#...##..#....##........##..\n" +
                    "..##.##...##.#.#....#..#......#\n" +
                    "....#....#..#..#.#....#..###...\n" +
                    "####.....##.#.##...##..#....#..\n" +
                    "#........##...#..###..#.#.#.##.\n" +
                    ".......###........##...#...#...\n" +
                    "#.#...#..#..#...#...##.##......\n" +
                    "..#...........#......##.#.#....\n" +
                    "#..#.#......##.#...#..#.#..#...\n" +
                    ".#....#....#..#.....#..###..#.#\n" +
                    ".##....................#.###.#.\n" +
                    "..#......#.#......#..###.......\n" +
                    "#.###..##..###....#........#..#\n" +
                    ".....#...#.......#.#.#...#....#\n" +
                    "....##..#.##..#.##..#.#....#...\n" +
                    ".#..#..#......#..##.#.#....##.#\n" +
                    ".....#.....#.##...#.#.##.#.....\n" +
                    ".#...#..##.....#.........#.#...\n" +
                    ".....#........#........#..#..#.\n" +
                    "#......##....#..#.#...#...#....\n" +
                    "#......#.#.......##.#..#.#.#...\n" +
                    "...###...##.#..........#...#...\n" +
                    "...#.##...#......#.##....#.#...\n" +
                    "#...#.....#........#..#....##.#\n" +
                    "##.#....##...##.####.##.......#\n" +
                    "..#..#...#.#.......#.##.#......\n" +
                    "##.........#.##....#.#...#.....\n" +
                    "##..#......#....#.....#...#....\n" +
                    "......##.#.#.....#.#.###...#...\n" +
                    "##.......#......#.#..#...#.##..\n" +
                    "#....#....#..#.#..#.#..........\n" +
                    "...#....#.#.#.#.....##.#..#.##.\n" +
                    "......#.#.#....#...##.#..#.....\n" +
                    "..##..#.##....#...#.....#..#.##\n" +
                    ".#...#.#.##..##........#.#...#.\n" +
                    "##.##.##....#.#....##.###......\n" +
                    "#...........#....##..#......#..\n" +
                    "...##..#.....#....#....#.#..##.\n" +
                    ".#..#.##..##..#.........#.....#\n" +
                    ".##......##.#.#......##....#...\n" +
                    ".....##.#....#...#...........##\n" +
                    "..#.....#..##...#.#..#.........\n" +
                    "...#.####..#.###.....#.....##..\n" +
                    ".....#..##..#.###........#.#...\n" +
                    "#..#.#.....#.....#...#...#....#\n" +
                    ".#...........#..#.........##...\n" +
                    "...#.#.#.......#..............#\n" +
                    ".##.#..#...#........#.##.#.#.#.\n" +
                    "....#....#.......#......#.#....\n" +
                    "##.#..##.....##..#...#....#..#.\n" +
                    "#.........#.#..###...#....#..#.\n" +
                    "....##.###...#........##...#.##\n" +
                    ".#...#..##.##...........##...##\n" +
                    ".....#.##........#.#.......##..\n" +
                    ".....#......#..#..#...#.#...#..\n" +
                    ".....#.....#.#..#.###......####\n" +
                    "........#.......#...........#..\n" +
                    "...#.##..#....######..#.#...#..\n" +
                    "#...##...####..##.....##...#...\n" +
                    ".#.......#.###..#.##..#..#.#.#.\n" +
                    "....#..#....##.....#........#.#\n" +
                    ".#..#....##..#........#...#...#\n" +
                    "#.#..#.#...##...#..........#.#.\n" +
                    "##.####....##....#...##.####...\n" +
                    "..##......##....#.....#...#..#.\n" +
                    "...#......#..#...#..#.#....#.#.\n" +
                    "......#...#....##....#.##......\n" +
                    ".##...#.........####..#....#..#\n" +
                    "...#..#.#......#.....#.#.#.#...\n" +
                    "...........#.......#........##.\n" +
                    "#.#....#....#.##.#...#...#.#...\n" +
                    "#..#.....#..#..#.#...#........#\n" +
                    ".....#.#.##...#............#.##\n" +
                    "..#.#.#...#...#..###.#.....#...\n" +
                    "....#.....##.......#......#....\n" +
                    ".#.#....#.##......##.#.#.....#.\n" +
                    ".....#.##.....#.#...#....#....#\n" +
                    "...#.......#..#.#.###.#.###....\n" +
                    ".#...#..#..#....#...###.#.##...\n" +
                    ".#....#........#..........##...\n" +
                    "##.#......#..#.#..........#.#..\n" +
                    "...#..#.......#.##..###....#.#.\n" +
                    ".#.....#..........#..#.........\n" +
                    "...##...##.#.......#..#....#...\n" +
                    ".....#.##....#.#.#...#.......#.\n" +
                    "...#.#..#.#.......#.....##..#..\n" +
                    ".#.#.......#.#..........#...#.#\n" +
                    "#........#...#....###.#...#....\n" +
                    "..##....#.#.#.....###.#.#......\n" +
                    "..#.....#.#...#.#.....#.#......\n" +
                    ".#.....##......#....##.#.#....#\n" +
                    "...##..........#.#####...#..#..\n" +
                    "#....#......##.............#...\n" +
                    "......#.....#...##..#.#....#..#\n" +
                    "..###.#.###.#.##.#.##..#.....#.\n" +
                    "#...#....#.#....#..##...#...#.#\n" +
                    "...#....#...#.#......#......#..\n" +
                    "#......#.....#.#..#........#...\n" +
                    "...##...##...##..###...###.#...\n" +
                    "#..#...#...#.....#..###...##...\n" +
                    ".#.....#.......#....#....##....\n" +
                    "......#......##.#.#......#.#...\n" +
                    "..#....#.#..........#..#...#..#\n" +
                    "###...#..............#.........\n" +
                    ".###.##..#.#..#.....#.#.##....#\n" +
                    "..#......#.##....##......#....#\n" +
                    ".##....###.#..#.#.............#\n" +
                    "..##..#..#.#.#....#..##.#..#..#\n" +
                    "##.#.....##...#..#...#..#.#.#..\n" +
                    ".#.#..............#.#...#......\n" +
                    "#....##...#....#..#...#........\n" +
                    "...#..#..#.#........#..#..#..##\n" +
                    "...##.#.#.#....#.......#....#..\n" +
                    ".##.#......#.##........#...##..\n" +
                    ".#.##..#.....###..#.#......#..#\n" +
                    "#....#..#......#....##...#..#.#\n" +
                    "..##....#.##...#..#.##....##..#\n" +
                    "#....#..#...#.......#...#......\n" +
                    "#.#......#....#.#..............\n" +
                    "..##..#..#.#.......#.#.#...##..\n" +
                    "...##.##......#..#.##.#.......#\n" +
                    ".##.........#............#.#...\n" +
                    "........#...#.....#....#....#..\n" +
                    "#....##...#........#......##...\n" +
                    ".###....#..#.#......#....#.#...\n" +
                    "#.#...........#...#....#..#.#.#\n" +
                    ".#....##.###...#.##....##..#..#\n" +
                    "........#.............#.#...#.#\n" +
                    "#.##..#.##....##.......#.......\n" +
                    ".#.....#..#.##..##.....#.......\n" +
                    "....#.#......#.#.............#.\n" +
                    "..#.#.......#...#......##..#...\n" +
                    "......##..###....##.#.###..##.#\n" +
                    "..#..#.##...#...#....#.##..#..#\n" +
                    "#.##...##.##.#.#........#......\n" +
                    "...#.#.......##....#.......#...\n" +
                    ".#....#.##.#..#.......#.....##.\n" +
                    "#..#...##.####..###.....#......\n" +
                    "..#...##...#...#.#......#...#.#\n" +
                    ".##.##.#...#.....#.##..##......\n" +
                    ".#...#.#.##.###..#...#...#.....\n" +
                    ".#..##..#....##.##....##....##.\n" +
                    "..#...##....#..###........##...\n" +
                    ".#..#..#.#....#.#...#.#......#.\n" +
                    ".##.....#...#..#..#..#...###...\n" +
                    ".#...#....#..#...........###...\n" +
                    ".....#...........##.#......#...\n" +
                    ".....#....##......##..#.#......\n" +
                    ".#.#..#..#...#.#..#..##..#.#...\n" +
                    "..#..#####.#..#.#.#.....#.#....\n" +
                    "#......#.##.#......#.#......#..\n" +
                    ".#...............#..#.#.......#\n" +
                    "...##...##.....##.##......#..##\n" +
                    "#.......##.#...........#....#..\n" +
                    "#...##.#...#.#..#..###...##....\n" +
                    "#..##..#..#......#.#...###..#.#\n" +
                    ".#.#..###.##..##.....#.........\n" +
                    "##.#..##.#..........#.......#..\n" +
                    ".###..##....##..#..#...##......\n" +
                    "........#..##.##....#....#.....\n" +
                    ".....#.#.#........#...#....#.#.\n" +
                    "..#..#.#.....#.##....##........\n" +
                    "...#....................#....#.\n" +
                    "..#....#..###.##......#..#.#.##\n" +
                    ".....#.#....#......#...#......#\n" +
                    "###...##.......#.#.#.....#....#\n" +
                    "..#..###.##..#..#....##.......#\n" +
                    "#...#.###..#...#.##..##........\n" +
                    "..#..#....#...........##..#....\n" +
                    ".#............##..#...##.#..#..\n" +
                    ".#.......#.#.........##..#..#..\n" +
                    "....#.###.#...##....#.#.##.....\n" +
                    "#.......#........#..#.##......#\n" +
                    "#.....###....#....#..#....#....\n" +
                    "...........#...#........#.....#\n" +
                    "..##...#...#.##...##.#.#..#...#\n" +
                    "##.##..#.......##..........#..#\n" +
                    "............#.....#...#..#....#\n" +
                    ".....#.#......#...#..#.#...#..#\n" +
                    "............##.##.....##...#..#\n" +
                    "##.#..#..#.#......#......#..##.\n" +
                    "..#..#.........#...#..#.#.#....\n" +
                    "#..#........#.......###.#......\n" +
                    "...#.#.#....#......#.#...#.....\n" +
                    "#...............#...#......##..\n" +
                    "###.#...#......##.....#..##.##.\n" +
                    "#.##...##.......###.##.........\n" +
                    ".#.#.........#..#.....#........\n" +
                    "..##..#............#.....#...##\n" +
                    "......###...#.#...#..#...##....\n" +
                    "#.........#.#.##.........##....\n" +
                    ".#....##....#....##....#.##....\n" +
                    ".#...##.#...#.......#...#....##\n" +
                    "#................#......##.....\n" +
                    "##..#......#.#.........##...##.\n" +
                    "...#.#.#...#..#..##..#....#.#..\n" +
                    ".##........#.#......##...#..#..\n" +
                    "...##....#.#.....##..#.........\n" +
                    "........###.#.#....###.##.#....\n" +
                    ".............#....###.#..#.#...\n" +
                    ".#...........##....#...#.......\n" +
                    "#..#.......#.....##..#.........\n" +
                    "..#.#..#....##...##.#.......#.#\n" +
                    "#.###.#.........#..#.........#.\n" +
                    ".......#.........##....##.#..##\n" +
                    ".##...###..........#....#.#..##\n" +
                    ".#.....#......##..#...#........\n" +
                    "##..#..###........#.......#....\n" +
                    "........#...#.##...........#.#.\n" +
                    ".....#..#..###.............#..#\n" +
                    "...######.##.....#...#......#..\n" +
                    ".#...#....###...###......#.##..\n" +
                    "...##.####.........#...#...##..\n" +
                    "..##....#.......#.....#..#.....\n" +
                    "#.##....#.#........#.....##....\n" +
                    ".....#.#.###...........#...##.#\n" +
                    ".............###........#......\n" +
                    "...#..#...##.#....#..##.#.....#\n" +
                    "....#.#.....#...#......###..##.\n" +
                    "........#.......#..#...........\n" +
                    "....#.#...#......#.#.....###...\n" +
                    "..#.............####.##.....#..\n" +
                    "..........#...#.#..............\n" +
                    "..#.#...........#.#..##...##..#\n" +
                    ".......#...#........#..##....##\n" +
                    "#...#.....#.#.##...#.#.#...#..#\n" +
                    ".....#..#....#.###.#.....#.#..#\n" +
                    "....#.#.#...#.................#\n" +
                    "#..#........##.###....#....#...\n" +
                    "..##...##..............##....#.\n" +
                    "...#.#...#.#...##........#...#.\n" +
                    "##..##.#..#.#.#..#.#...#.#.#.##\n" +
                    "..#.#..#....#..#.###.........#.\n" +
                    "..#.....#..#..#........#.......\n" +
                    "...#...#......##...###.....##..\n" +
                    "#....#.##.....#.##..##..#..#...\n" +
                    "......##..#.#.#..#.###...#...#.\n" +
                    ".##.....##............#.#......\n" +
                    "..#.#........##....#..#.####.#.\n" +
                    ".#....###..#.......#...........\n" +
                    "##...........#..#...#.....#.#..\n" +
                    ".#..#....#..#....#.#.........#.\n" +
                    ".#.###....#.....##.....##......\n" +
                    ".#.#.......#.......#.###.#...#.\n" +
                    "...###..#..#....#..####.##....#\n" +
                    "..........##...#...#...........\n" +
                    ".#.....#.#..##..##...##..#.....\n" +
                    "##.......#.#...#..###..#..##...\n" +
                    "..#.##......###..#........#..##\n" +
                    "....###...#..........#.#..#.#..\n" +
                    "#..#.#..##.......##....#.#..##.\n" +
                    ".#...#...#..#....#...###.......\n" +
                    ".##.#.#.#.....#.....#.#.#.....#\n" +
                    "...##.#.....#..#.#...#.####.#..\n" +
                    "#...##.....####..#.###.##..#.##\n" +
                    "..###..##....#####......##.....\n" +
                    "###..............#.#..........#\n" +
                    "#...##......##....#...#..##..#.\n" +
                    ".#..#...#....##.##.....#....##.\n" +
                    "...#.#...#..#..#.......#.##....\n" +
                    ".#...#..#.......#.##.#..#...#.#\n" +
                    ".#..#.##...#...#.............#.\n" +
                    ".#.#.#....##..#.#.#.#.#......##\n" +
                    "..#....#.#...##.##.#...#.#.#.#.\n" +
                    "...#..#..##.........##..#.....#\n" +
                    "....#..........#.#.......#.....\n" +
                    "........#....#.#..#.....#.#.#..\n" +
                    ".#...#.......#..#.##.........#.\n" +
                    "##......#.....#...........#.#..\n" +
                    "....#....##...#..#####.####...#\n" +
                    ".....##....#....#..#.....#..##.\n" +
                    ".#...#.#..###....#......#...#..\n" +
                    ".#.#.#.#.....##..........#....#\n" +
                    "...#.....#.....#..#............\n" +
                    "...#.#..#.....#.............#..\n" +
                    "......#....#.#.....#.##...#..#.\n" +
                    "...#....#.#...##..#....###.....\n" +
                    "...#..#............##...##.##..\n" +
                    "..#....#..............#.....#..\n" +
                    ".#..#.......#.#.##......#.###..\n" +
                    "..#...#.........#..#.....#.....\n" +
                    "#..........#.....##............\n" +
                    "##.#.#.#....##......#..#....#.#\n" +
                    ".#..#.....#.#..#.....#..##.....\n" +
                    "...#.#.....#..#..#..#.##.###...\n" +
                    "...##.#.....#.....#.......#....\n" +
                    ".....................##.#...#..\n" +
                    "...#.#...#...#...###..#..#.#...\n" +
                    "#....##..###.#...##.#......#..#\n" +
                    ".##...##..##...##......##.#....\n" +
                    "............#.....#.##.#.##.#.#\n" +
                    ".#...##.#..........###......#..\n" +
                    ".....##.....##....#.#....##..#.\n" +
                    "...#....#.....#....#.....#.#...\n" +
                    "................##.#...#....##.\n" +
                    "#..###.......#......###......#.\n" +
                    "###..#.........#.#.#.....#....#\n" +
                    "..#.#......#....#.#......##...#\n" +
                    "#...#......#.#.#.#..#...#..###.\n" +
                    ".#...#..#...##..#...##....###..\n" +
                    "#.#.#.#..###................#.#\n" +
                    "...#.####....##.#.....#..#.....\n" +
                    "#.#...##..#.#...###.#..#...#...\n" +
                    "#..####........#.#..#...##..##.\n" +
                    "..#..###..#..........##.###...#\n" +
                    ".....#..###.#.#....#....##....#\n" +
                    ".###..#.#.#....#...##.......##.\n" +
                    "#..#..........#...............#\n" +
                    ".#.#...#.....#.###..##......##.\n" +
                    "#...#...#...##...##.....##..#..\n" +
                    ".....##..###...........#.......\n" +
                    "........###..##........#..##..#\n" +
                    "#....#...##..##..#.#.#.###...#.\n" +
                    ".#..#......##.#..#...#.........\n" +
                    ".#....#.##.....................\n" +
                    "#.##.##...........#.####..#....\n" +
                    "......##....#..#.....#.#....#..\n" +
                    "....##.#........#.#.#.#.#..#..#\n" +
                    ".#..##..##..#.....#...#.#.....#\n" +
                    "...#..#.#.....#..#..##....##..#\n" +
                    "..#....#.....#........#.....#..\n" +
                    "#.#.#..#..#.#..#...###.#.#....#";

    private static final String[] INPUT_AS_LINE_ARRAY = INPUT.split("\\R");

    public static class Slope {
        final int right;
        final int down;

        public Slope(int right, int down) {
            this.right = right;
            this.down = down;
        }
    }

    private static final Slope[] SLOPES = {
            new Slope(1, 1),
            new Slope(3, 1),
            new Slope(5, 1),
            new Slope(7, 1),
            new Slope(1, 2)
    };

    /**
     * Get tree character at specified position (or null if y is out of range).
     * Top left position is 1:1, x increases to the right, y increases to the bottom.
     * Note that the pattern repeats any number of times to the right, but not to the bottom.
     *
     * @param x
     * @param y
     * @return
     */
    private static Character getTreeAt(int x, int y) {
        int technicalX = x - 1;
        int technicalY = y - 1;
        if (technicalY >= INPUT_AS_LINE_ARRAY.length) {
            return null;
        }
        String relevantLine = INPUT_AS_LINE_ARRAY[technicalY];
        technicalX = technicalX % relevantLine.length();
        return relevantLine.charAt(technicalX);
    }

    private static long countTrees(Slope slope) {
        int x = 1;
        int y = 1;
        int treeCounter = 0;
        Character tree = getTreeAt(x, y);
        while (tree != null) {
            if (tree == '#') {
                treeCounter++;
            }
            x += slope.right;
            y += slope.down;
            tree = getTreeAt(x, y);
        }
        return treeCounter;
    }

    public static long doPuzzle1() {
        return countTrees(SLOPES[1]);
    }

    public static long doPuzzle2() {
        long treeCounter;
        long product = 1;
        for (Slope slope : SLOPES) {
            treeCounter = countTrees(slope);
            System.out.println(treeCounter);
            product *= treeCounter;
        }
        return product;
    }
}
