package com.github.rviehmann.aoc2021;

import java.util.Arrays;
import java.util.List;
import java.util.stream.Collectors;

import static java.lang.Long.parseLong;

public class Day03 {

    private static final String SAMPLE =
            "00100\n" +
                    "11110\n" +
                    "10110\n" +
                    "10111\n" +
                    "10101\n" +
                    "01111\n" +
                    "00111\n" +
                    "11100\n" +
                    "10000\n" +
                    "11001\n" +
                    "00010\n" +
                    "01010";

    // From: https://adventofcode.com/2021/day/3/input
    private static final String INPUT =
            "110001010111\n" +
                    "011011110010\n" +
                    "110011110011\n" +
                    "101000010111\n" +
                    "011101100100\n" +
                    "111001011100\n" +
                    "011100000101\n" +
                    "011110110011\n" +
                    "001001111111\n" +
                    "111000010000\n" +
                    "001000101100\n" +
                    "011100111010\n" +
                    "011100111000\n" +
                    "011100010001\n" +
                    "100001100000\n" +
                    "111010111110\n" +
                    "100011000101\n" +
                    "010111000101\n" +
                    "100110110011\n" +
                    "101010110011\n" +
                    "110101110010\n" +
                    "110111100010\n" +
                    "000001100100\n" +
                    "010010011010\n" +
                    "001001001100\n" +
                    "101000000111\n" +
                    "100100110011\n" +
                    "111111100011\n" +
                    "110010001010\n" +
                    "100010110011\n" +
                    "111101101001\n" +
                    "101001001101\n" +
                    "110111011101\n" +
                    "100100101101\n" +
                    "111111000011\n" +
                    "001110010110\n" +
                    "010110110010\n" +
                    "010011100000\n" +
                    "110011100011\n" +
                    "111101001011\n" +
                    "100001101000\n" +
                    "100101100011\n" +
                    "010101100110\n" +
                    "101000001001\n" +
                    "010001011100\n" +
                    "111001010010\n" +
                    "000110000110\n" +
                    "110110111111\n" +
                    "111111010000\n" +
                    "110111110011\n" +
                    "110110010010\n" +
                    "000001001111\n" +
                    "010001000111\n" +
                    "101101100110\n" +
                    "110011100100\n" +
                    "101000010100\n" +
                    "010100010000\n" +
                    "100011001001\n" +
                    "011000111101\n" +
                    "000101011101\n" +
                    "000110111110\n" +
                    "011000101100\n" +
                    "110101101001\n" +
                    "100011110011\n" +
                    "110101010001\n" +
                    "100010100000\n" +
                    "110010010001\n" +
                    "000101101011\n" +
                    "101100111011\n" +
                    "111110110001\n" +
                    "011001000100\n" +
                    "001101111000\n" +
                    "100100100101\n" +
                    "101111001000\n" +
                    "011010110110\n" +
                    "001110011111\n" +
                    "101011001001\n" +
                    "110000100010\n" +
                    "011110100110\n" +
                    "001100101100\n" +
                    "000110000001\n" +
                    "011111001111\n" +
                    "011000110010\n" +
                    "001100011111\n" +
                    "111100010100\n" +
                    "010011111000\n" +
                    "000100101010\n" +
                    "101111100101\n" +
                    "010000001100\n" +
                    "100100101111\n" +
                    "100011101100\n" +
                    "000001111000\n" +
                    "001110000011\n" +
                    "011101011001\n" +
                    "000001111101\n" +
                    "000011001011\n" +
                    "111111000110\n" +
                    "000001011100\n" +
                    "011001100000\n" +
                    "111001011101\n" +
                    "011010000011\n" +
                    "101010101110\n" +
                    "010110010101\n" +
                    "000011101101\n" +
                    "010010011000\n" +
                    "000010100111\n" +
                    "001000000111\n" +
                    "111111011100\n" +
                    "101010010000\n" +
                    "101001001100\n" +
                    "000000100111\n" +
                    "101010101100\n" +
                    "010110100111\n" +
                    "001010001101\n" +
                    "111000000101\n" +
                    "111001101100\n" +
                    "011110010001\n" +
                    "011001111010\n" +
                    "010010011011\n" +
                    "011110111000\n" +
                    "010111110000\n" +
                    "001110001011\n" +
                    "010001001011\n" +
                    "011001001010\n" +
                    "011001001101\n" +
                    "001101011101\n" +
                    "100110100000\n" +
                    "100001111110\n" +
                    "101110100011\n" +
                    "100010111111\n" +
                    "001010010011\n" +
                    "000010011001\n" +
                    "011001111101\n" +
                    "000100000010\n" +
                    "100110010011\n" +
                    "001111001000\n" +
                    "110001011101\n" +
                    "000100011000\n" +
                    "111110000000\n" +
                    "111001101000\n" +
                    "100111000100\n" +
                    "010000010100\n" +
                    "011000110111\n" +
                    "000110001101\n" +
                    "101100110010\n" +
                    "011111101001\n" +
                    "000000100010\n" +
                    "000001101000\n" +
                    "111001111101\n" +
                    "111100010111\n" +
                    "110000010101\n" +
                    "110000101100\n" +
                    "101111010011\n" +
                    "000100010101\n" +
                    "100111100011\n" +
                    "110100101111\n" +
                    "101000001000\n" +
                    "001000100000\n" +
                    "100111111010\n" +
                    "001101111101\n" +
                    "000000101000\n" +
                    "100111101100\n" +
                    "100111010100\n" +
                    "111100010110\n" +
                    "100001010011\n" +
                    "010010001000\n" +
                    "111101010101\n" +
                    "101110101010\n" +
                    "111110001110\n" +
                    "001010111010\n" +
                    "100110001000\n" +
                    "101111001111\n" +
                    "110010011101\n" +
                    "110001110101\n" +
                    "011101000000\n" +
                    "010011110110\n" +
                    "001110101001\n" +
                    "011110011010\n" +
                    "110010111100\n" +
                    "010000100001\n" +
                    "010010000100\n" +
                    "111111000101\n" +
                    "010111100111\n" +
                    "101010110010\n" +
                    "100010010011\n" +
                    "101011010000\n" +
                    "000101100000\n" +
                    "011001000011\n" +
                    "010110000000\n" +
                    "101011101111\n" +
                    "001101001110\n" +
                    "001100100110\n" +
                    "011111110011\n" +
                    "010000101101\n" +
                    "000111101101\n" +
                    "111100101101\n" +
                    "000011001101\n" +
                    "110011111100\n" +
                    "011000110000\n" +
                    "000001010010\n" +
                    "111100111111\n" +
                    "001010000100\n" +
                    "000011010010\n" +
                    "010001000001\n" +
                    "111010111000\n" +
                    "110001010011\n" +
                    "000000101011\n" +
                    "011110011011\n" +
                    "100110111000\n" +
                    "010010110010\n" +
                    "000010111110\n" +
                    "110010001001\n" +
                    "000111001001\n" +
                    "001000011100\n" +
                    "111111011010\n" +
                    "000000110101\n" +
                    "111011111011\n" +
                    "100001110111\n" +
                    "010001110000\n" +
                    "010101100100\n" +
                    "011010100001\n" +
                    "111000101101\n" +
                    "001100110110\n" +
                    "010001111110\n" +
                    "100000101011\n" +
                    "011111111001\n" +
                    "111000001100\n" +
                    "011111100011\n" +
                    "110110110000\n" +
                    "011000101010\n" +
                    "101000000011\n" +
                    "101111110100\n" +
                    "011000101101\n" +
                    "001000011010\n" +
                    "101001100111\n" +
                    "101100001101\n" +
                    "100100101100\n" +
                    "001101011001\n" +
                    "001111100111\n" +
                    "011100101001\n" +
                    "110010000000\n" +
                    "010100111000\n" +
                    "000011010111\n" +
                    "000000100110\n" +
                    "101001000000\n" +
                    "000110100100\n" +
                    "110001110011\n" +
                    "001011001101\n" +
                    "100000111100\n" +
                    "101011011111\n" +
                    "000010110110\n" +
                    "010101110100\n" +
                    "111100111001\n" +
                    "111010101101\n" +
                    "101100001001\n" +
                    "011111000111\n" +
                    "010001101000\n" +
                    "100000001111\n" +
                    "011111101100\n" +
                    "011111100111\n" +
                    "111101111110\n" +
                    "110110100101\n" +
                    "011110001011\n" +
                    "100111100001\n" +
                    "000001101101\n" +
                    "100110101110\n" +
                    "100000010011\n" +
                    "110000000001\n" +
                    "001001101001\n" +
                    "000001111111\n" +
                    "111001001010\n" +
                    "101011100101\n" +
                    "100100000000\n" +
                    "110001101011\n" +
                    "011111001011\n" +
                    "010010001011\n" +
                    "000101010011\n" +
                    "110010110100\n" +
                    "101010101011\n" +
                    "100100001100\n" +
                    "000001100011\n" +
                    "101010000010\n" +
                    "111101100100\n" +
                    "001011010111\n" +
                    "000001010001\n" +
                    "001010001011\n" +
                    "100110000011\n" +
                    "000010101010\n" +
                    "110111011100\n" +
                    "001100111000\n" +
                    "111011010111\n" +
                    "100100110000\n" +
                    "000010111010\n" +
                    "000011010001\n" +
                    "100001111111\n" +
                    "111111000100\n" +
                    "010111111000\n" +
                    "100101010010\n" +
                    "001111111010\n" +
                    "001111011100\n" +
                    "111101100111\n" +
                    "111011011011\n" +
                    "111000100110\n" +
                    "011101001011\n" +
                    "010100101010\n" +
                    "010100001111\n" +
                    "010000001111\n" +
                    "000000000010\n" +
                    "010011010111\n" +
                    "001101001011\n" +
                    "101011001011\n" +
                    "011001101101\n" +
                    "100000000111\n" +
                    "100110011010\n" +
                    "000101000110\n" +
                    "101100010011\n" +
                    "101011011100\n" +
                    "001101010100\n" +
                    "110101110111\n" +
                    "001100001000\n" +
                    "001001100100\n" +
                    "111101011010\n" +
                    "001100100100\n" +
                    "100000100010\n" +
                    "001110111001\n" +
                    "101101001110\n" +
                    "001101110111\n" +
                    "010101100101\n" +
                    "000011111110\n" +
                    "001000111101\n" +
                    "110011101011\n" +
                    "110101011000\n" +
                    "000000100101\n" +
                    "100110100001\n" +
                    "111111101101\n" +
                    "010100101111\n" +
                    "110101011010\n" +
                    "011010011100\n" +
                    "101101010001\n" +
                    "101001010011\n" +
                    "011111001100\n" +
                    "101001010111\n" +
                    "011100100011\n" +
                    "101011110000\n" +
                    "010111001010\n" +
                    "111011000111\n" +
                    "100111001101\n" +
                    "001110111010\n" +
                    "100001111000\n" +
                    "111011010011\n" +
                    "110000101010\n" +
                    "011010000000\n" +
                    "110001111010\n" +
                    "100101000100\n" +
                    "010000110100\n" +
                    "101000101010\n" +
                    "011010101110\n" +
                    "010000111100\n" +
                    "101011100100\n" +
                    "101101111010\n" +
                    "111011111110\n" +
                    "000101010111\n" +
                    "000010111000\n" +
                    "011101101010\n" +
                    "101110100110\n" +
                    "010000011010\n" +
                    "101100100000\n" +
                    "010011010101\n" +
                    "101100011100\n" +
                    "011010101010\n" +
                    "010111101010\n" +
                    "111011100111\n" +
                    "111111110010\n" +
                    "101101100100\n" +
                    "111001010100\n" +
                    "011000001110\n" +
                    "110110001110\n" +
                    "111110100110\n" +
                    "001011011100\n" +
                    "101000010010\n" +
                    "100000101010\n" +
                    "010000011110\n" +
                    "001001110111\n" +
                    "001001001011\n" +
                    "110010011110\n" +
                    "001111001100\n" +
                    "110110100010\n" +
                    "111100000111\n" +
                    "010101101011\n" +
                    "001111111001\n" +
                    "101011000000\n" +
                    "011100011000\n" +
                    "000001000000\n" +
                    "100101001100\n" +
                    "110010011001\n" +
                    "111100111110\n" +
                    "010000110110\n" +
                    "110000111000\n" +
                    "110111100001\n" +
                    "000100100010\n" +
                    "100010001110\n" +
                    "010000111101\n" +
                    "111100011000\n" +
                    "110000000101\n" +
                    "000000000001\n" +
                    "010011111100\n" +
                    "011011111101\n" +
                    "111001111010\n" +
                    "001001001001\n" +
                    "010101011010\n" +
                    "011010011111\n" +
                    "001111000011\n" +
                    "101111111111\n" +
                    "000111101000\n" +
                    "011000111110\n" +
                    "001100101101\n" +
                    "101000000110\n" +
                    "000100001010\n" +
                    "111110010101\n" +
                    "000011101000\n" +
                    "011010101000\n" +
                    "100111100000\n" +
                    "111001111111\n" +
                    "010101000111\n" +
                    "011000100101\n" +
                    "001001110001\n" +
                    "101101011011\n" +
                    "001000001100\n" +
                    "111110111010\n" +
                    "011110111010\n" +
                    "111101100001\n" +
                    "011111101000\n" +
                    "110100010100\n" +
                    "010001110011\n" +
                    "000011010011\n" +
                    "010000110010\n" +
                    "000011111011\n" +
                    "101111011000\n" +
                    "010101111110\n" +
                    "100100101011\n" +
                    "001000011011\n" +
                    "011000100000\n" +
                    "100100111101\n" +
                    "001010110011\n" +
                    "000000000000\n" +
                    "000110111011\n" +
                    "001001011001\n" +
                    "011101010010\n" +
                    "000111000011\n" +
                    "010001000100\n" +
                    "011110011111\n" +
                    "010010111011\n" +
                    "100000000011\n" +
                    "001100111101\n" +
                    "000001000110\n" +
                    "000010000010\n" +
                    "101111001010\n" +
                    "000111000001\n" +
                    "100101011100\n" +
                    "111001110100\n" +
                    "100111001111\n" +
                    "011110111111\n" +
                    "010101011110\n" +
                    "101010011011\n" +
                    "101000010101\n" +
                    "101001101000\n" +
                    "001001011101\n" +
                    "010110101100\n" +
                    "101110111100\n" +
                    "000111011110\n" +
                    "010111001101\n" +
                    "001101100010\n" +
                    "011101001111\n" +
                    "100111111111\n" +
                    "000110101110\n" +
                    "011110001110\n" +
                    "110011100111\n" +
                    "010011100101\n" +
                    "100101000011\n" +
                    "100101010011\n" +
                    "111000110110\n" +
                    "110111011111\n" +
                    "000100011110\n" +
                    "100000000001\n" +
                    "010111111111\n" +
                    "100000100011\n" +
                    "110010011111\n" +
                    "111101110110\n" +
                    "001000001001\n" +
                    "001100011001\n" +
                    "111100110001\n" +
                    "100110100101\n" +
                    "010111101000\n" +
                    "000000000110\n" +
                    "000011011001\n" +
                    "100100001111\n" +
                    "001111100100\n" +
                    "001011010011\n" +
                    "001000110011\n" +
                    "110100010010\n" +
                    "011100110111\n" +
                    "011010110010\n" +
                    "011001110110\n" +
                    "011011100010\n" +
                    "001110101011\n" +
                    "101101100111\n" +
                    "101101111100\n" +
                    "000110000101\n" +
                    "000001110010\n" +
                    "001101110010\n" +
                    "101011000100\n" +
                    "000110000000\n" +
                    "001001011111\n" +
                    "100101101011\n" +
                    "001010100001\n" +
                    "110000111110\n" +
                    "011111101111\n" +
                    "110110111100\n" +
                    "001000010110\n" +
                    "000101111110\n" +
                    "111001000001\n" +
                    "000100110011\n" +
                    "110110000101\n" +
                    "101100101011\n" +
                    "101110000010\n" +
                    "011101100001\n" +
                    "010011000001\n" +
                    "010111000011\n" +
                    "010111011101\n" +
                    "101010100001\n" +
                    "000111011011\n" +
                    "101110010000\n" +
                    "110000000010\n" +
                    "101100011101\n" +
                    "011000011000\n" +
                    "001111101101\n" +
                    "101000001010\n" +
                    "101011010001\n" +
                    "011111100001\n" +
                    "101001011110\n" +
                    "100101011000\n" +
                    "011110001100\n" +
                    "111100011110\n" +
                    "010011101110\n" +
                    "001001110000\n" +
                    "001001000011\n" +
                    "100001010000\n" +
                    "000110010000\n" +
                    "110111010111\n" +
                    "000100110101\n" +
                    "001110101000\n" +
                    "101011000011\n" +
                    "001011100000\n" +
                    "111111111111\n" +
                    "111111011110\n" +
                    "110001100001\n" +
                    "001000001111\n" +
                    "101000100100\n" +
                    "001011001001\n" +
                    "110110001101\n" +
                    "000100000000\n" +
                    "011100001101\n" +
                    "110011001000\n" +
                    "001111011101\n" +
                    "010000111111\n" +
                    "010110011110\n" +
                    "011110111011\n" +
                    "101111011101\n" +
                    "001100011000\n" +
                    "001011111001\n" +
                    "000110001011\n" +
                    "011011010100\n" +
                    "111110001011\n" +
                    "010000110111\n" +
                    "001100011101\n" +
                    "011110111001\n" +
                    "000010101001\n" +
                    "001110000001\n" +
                    "011111010101\n" +
                    "000010010100\n" +
                    "000101011001\n" +
                    "100100000001\n" +
                    "001111101011\n" +
                    "111110010011\n" +
                    "000111111011\n" +
                    "001101010110\n" +
                    "001100111001\n" +
                    "000100011101\n" +
                    "111010010111\n" +
                    "000100000001\n" +
                    "001011101111\n" +
                    "101001110011\n" +
                    "001011110101\n" +
                    "011000001101\n" +
                    "110011001011\n" +
                    "011110111100\n" +
                    "110110101000\n" +
                    "011010001101\n" +
                    "110111001000\n" +
                    "110010010101\n" +
                    "011010001011\n" +
                    "000011100111\n" +
                    "011000110001\n" +
                    "001100001111\n" +
                    "110010011010\n" +
                    "101100101100\n" +
                    "001100000110\n" +
                    "010101001111\n" +
                    "000011000100\n" +
                    "110001000111\n" +
                    "001001011000\n" +
                    "001001001000\n" +
                    "000010111101\n" +
                    "100101001010\n" +
                    "011100111100\n" +
                    "101000011011\n" +
                    "101011010111\n" +
                    "111001000011\n" +
                    "100100100110\n" +
                    "011001011011\n" +
                    "000011110011\n" +
                    "001101000111\n" +
                    "011010010100\n" +
                    "101010101000\n" +
                    "100010110000\n" +
                    "100001011110\n" +
                    "100000110110\n" +
                    "001011101001\n" +
                    "000110100011\n" +
                    "111000101010\n" +
                    "111001011001\n" +
                    "101111010010\n" +
                    "011100101010\n" +
                    "100010111000\n" +
                    "010100101110\n" +
                    "011001110000\n" +
                    "000010001101\n" +
                    "101110000111\n" +
                    "011011001111\n" +
                    "011110001000\n" +
                    "010010100011\n" +
                    "110001100010\n" +
                    "001101011011\n" +
                    "110100000101\n" +
                    "101110100111\n" +
                    "001110111011\n" +
                    "000110100101\n" +
                    "100100100001\n" +
                    "101000111100\n" +
                    "100011101110\n" +
                    "110010000101\n" +
                    "101100011001\n" +
                    "100000010111\n" +
                    "011100100101\n" +
                    "000010011011\n" +
                    "001011001100\n" +
                    "011001000000\n" +
                    "000101000101\n" +
                    "100001001100\n" +
                    "000001101010\n" +
                    "110111101100\n" +
                    "111001101010\n" +
                    "110000110111\n" +
                    "000110010001\n" +
                    "011100000000\n" +
                    "010000111010\n" +
                    "000101000000\n" +
                    "010000101010\n" +
                    "010011110001\n" +
                    "101011010101\n" +
                    "100000110111\n" +
                    "101001110010\n" +
                    "100011011100\n" +
                    "010011100011\n" +
                    "100000100111\n" +
                    "110100110000\n" +
                    "000100001011\n" +
                    "101101011000\n" +
                    "010110011001\n" +
                    "010110111111\n" +
                    "101110010101\n" +
                    "011110001101\n" +
                    "110001001000\n" +
                    "001001101100\n" +
                    "100111010011\n" +
                    "001100010011\n" +
                    "110101111001\n" +
                    "100010101011\n" +
                    "111010001110\n" +
                    "110001100111\n" +
                    "111000010010\n" +
                    "001000001011\n" +
                    "111001000010\n" +
                    "100100100100\n" +
                    "110010101001\n" +
                    "111101101010\n" +
                    "111111100101\n" +
                    "100010010001\n" +
                    "001010010110\n" +
                    "111101011000\n" +
                    "001010111100\n" +
                    "001001111110\n" +
                    "100010100110\n" +
                    "100001110100\n" +
                    "001111001101\n" +
                    "101100100111\n" +
                    "101101100101\n" +
                    "100101110111\n" +
                    "000111110111\n" +
                    "000111001000\n" +
                    "010101000010\n" +
                    "011000111100\n" +
                    "001001001110\n" +
                    "111101010001\n" +
                    "001011010101\n" +
                    "100011000111\n" +
                    "100000001001\n" +
                    "011100011110\n" +
                    "010111011011\n" +
                    "011000010011\n" +
                    "101101011110\n" +
                    "000000100011\n" +
                    "111110010010\n" +
                    "111010011101\n" +
                    "001000100100\n" +
                    "110101100001\n" +
                    "100101101000\n" +
                    "001110111111\n" +
                    "010001000101\n" +
                    "111110000101\n" +
                    "101000001101\n" +
                    "110101010000\n" +
                    "111110101110\n" +
                    "011111011000\n" +
                    "001001001111\n" +
                    "000101010110\n" +
                    "001100110000\n" +
                    "001111101000\n" +
                    "101000100101\n" +
                    "010000000010\n" +
                    "110011000010\n" +
                    "000000001100\n" +
                    "010000101011\n" +
                    "010101011011\n" +
                    "101011010100\n" +
                    "010001011011\n" +
                    "111100011001\n" +
                    "100000111110\n" +
                    "110001101010\n" +
                    "100111101001\n" +
                    "100110001110\n" +
                    "110001010101\n" +
                    "101100001000\n" +
                    "100001000010\n" +
                    "000110100001\n" +
                    "001010000000\n" +
                    "011111100000\n" +
                    "111110101111\n" +
                    "000001101001\n" +
                    "000000111110\n" +
                    "101111101001\n" +
                    "001010000010\n" +
                    "011110010010\n" +
                    "101111000111\n" +
                    "111110101010\n" +
                    "000100001000\n" +
                    "000111000000\n" +
                    "110010010110\n" +
                    "000001111110\n" +
                    "010110101010\n" +
                    "001010100011\n" +
                    "001111011001\n" +
                    "111001001111\n" +
                    "100100010111\n" +
                    "101100001011\n" +
                    "100111000110\n" +
                    "111010111101\n" +
                    "010001011110\n" +
                    "101110000011\n" +
                    "010111000010\n" +
                    "110110001011\n" +
                    "111010100011\n" +
                    "111100011101\n" +
                    "101101101001\n" +
                    "110100001000\n" +
                    "110001011001\n" +
                    "110010100001\n" +
                    "111110010110\n" +
                    "010100100011\n" +
                    "001000011101\n" +
                    "001011001010\n" +
                    "011100111011\n" +
                    "001111100110\n" +
                    "001101100110\n" +
                    "001011000001\n" +
                    "010100100110\n" +
                    "100100100111\n" +
                    "010100011011\n" +
                    "000101110001\n" +
                    "010110011111\n" +
                    "000001011101\n" +
                    "110101011001\n" +
                    "001101101010\n" +
                    "011111111010\n" +
                    "111001100011\n" +
                    "100001000111\n" +
                    "110110011111\n" +
                    "100101010001\n" +
                    "011100100010\n" +
                    "100100011000\n" +
                    "101111001011\n" +
                    "111001011000\n" +
                    "110000101110\n" +
                    "010100100101\n" +
                    "110011101000\n" +
                    "001101000011\n" +
                    "111101100101\n" +
                    "011010011011\n" +
                    "100110001101\n" +
                    "111001111100\n" +
                    "001000100010\n" +
                    "000101111101\n" +
                    "101110011000\n" +
                    "001011111010\n" +
                    "111100101001\n" +
                    "011000101001\n" +
                    "001111010111\n" +
                    "001100110010\n" +
                    "011000011011\n" +
                    "110111011000\n" +
                    "100100000110\n" +
                    "011010110000\n" +
                    "110111101111\n" +
                    "111000111101\n" +
                    "111111100110\n" +
                    "000101010010\n" +
                    "010101001010\n" +
                    "110100110101\n" +
                    "011011100101\n" +
                    "110110111011\n" +
                    "100010111110\n" +
                    "100110111010\n" +
                    "100011001010\n" +
                    "100100100000\n" +
                    "101000110110\n" +
                    "001010101010\n" +
                    "011001101111\n" +
                    "001110110000\n" +
                    "010001100100\n" +
                    "011000100100\n" +
                    "001011001011\n" +
                    "110111100110\n" +
                    "010110010111\n" +
                    "001011011010\n" +
                    "111100001010\n" +
                    "000010001100\n" +
                    "011010001111\n" +
                    "100100001101\n" +
                    "100010011100\n" +
                    "000010001000\n" +
                    "101001010000\n" +
                    "110101001101\n" +
                    "010110111100\n" +
                    "101001100100\n" +
                    "100000111010\n" +
                    "010000010001\n" +
                    "011101011101\n" +
                    "100011110010\n" +
                    "100100011111\n" +
                    "100011100101\n" +
                    "001010010010\n" +
                    "000110011111\n" +
                    "010000000111\n" +
                    "111001101101\n" +
                    "010011000010\n" +
                    "000001111010\n" +
                    "010010001111\n" +
                    "101011100001\n" +
                    "101100111100\n" +
                    "100001000000\n" +
                    "110111110010\n" +
                    "100110000111\n" +
                    "100000111011\n" +
                    "111010011110\n" +
                    "011011011011\n" +
                    "101011000110\n" +
                    "011100011001\n" +
                    "000101011100\n" +
                    "010000101111\n" +
                    "100010100001\n" +
                    "111000100101\n" +
                    "011010010001\n" +
                    "110110100011\n" +
                    "100000011100\n" +
                    "101110101101\n" +
                    "000010110100\n" +
                    "101011111110\n" +
                    "001000100111\n" +
                    "101001001010\n" +
                    "001111110101\n" +
                    "001001000010\n" +
                    "001100101110\n" +
                    "111000001000\n" +
                    "000000100000\n" +
                    "000100111110\n" +
                    "111111110100\n" +
                    "110101001100\n" +
                    "001100000010\n" +
                    "100011011001\n" +
                    "000110000010\n" +
                    "100010101101\n" +
                    "111110101011\n" +
                    "110100000000\n" +
                    "000100111001\n" +
                    "001111001011\n" +
                    "110111011011\n" +
                    "001111100010\n" +
                    "101111011010\n" +
                    "111010011011\n" +
                    "100111101010\n" +
                    "011011011001\n" +
                    "010100000011\n" +
                    "001111010001\n" +
                    "101010101101\n" +
                    "110000011111\n" +
                    "001111111111\n" +
                    "000110000100\n" +
                    "101111101010\n" +
                    "101011011101\n" +
                    "010001011010\n" +
                    "001001011011\n" +
                    "101011010010\n" +
                    "111010000010\n" +
                    "011100101000\n" +
                    "101001011010\n" +
                    "000111110101\n" +
                    "110011011101\n" +
                    "101010010011\n" +
                    "101100001111\n" +
                    "111001010001\n" +
                    "100100010110\n" +
                    "010100100001\n" +
                    "011110110101\n" +
                    "110100000111\n" +
                    "110101001000\n" +
                    "101000010000\n" +
                    "110000000011\n" +
                    "011111110110\n" +
                    "100001010100\n" +
                    "011111000101\n" +
                    "010010101001\n" +
                    "000111100100\n" +
                    "001010000110\n" +
                    "100100110110\n" +
                    "110010101101\n" +
                    "010001111101\n" +
                    "101100000000\n" +
                    "001100000000\n" +
                    "011111111110\n" +
                    "110001100101\n" +
                    "000111001100\n" +
                    "011101111110\n" +
                    "000100110000\n" +
                    "111111111000\n" +
                    "101110010001\n" +
                    "100111000010\n" +
                    "100111011110\n" +
                    "000100111010\n" +
                    "110101011011\n" +
                    "001000111110\n" +
                    "101101110110\n" +
                    "110110010011\n" +
                    "011010100101\n" +
                    "001010101111\n" +
                    "100110111001\n" +
                    "010001111100\n" +
                    "010110101000\n" +
                    "011000000000\n" +
                    "010001011111\n" +
                    "010101101111\n" +
                    "111001010110\n" +
                    "100001001011\n" +
                    "110000100111\n" +
                    "011100000001\n" +
                    "110101100000\n" +
                    "110010110010\n" +
                    "111010111001\n" +
                    "011010111000\n" +
                    "101100000110\n" +
                    "010100011111\n" +
                    "001010111000\n" +
                    "101100101101\n" +
                    "011000111010\n" +
                    "000001001100\n" +
                    "001111010010\n" +
                    "011010100000\n" +
                    "110100110111\n" +
                    "101101000100\n" +
                    "001110001101\n" +
                    "111001101111\n";

    private static final String[] SAMPLE_AS_LINE_ARRAY = SAMPLE.split("\\R");

    private static final String[] INPUT_AS_LINE_ARRAY = INPUT.split("\\R");

    private static long puzzle2Logic(String[] input) {
        long oxygen = 0;
        long co2 = 0;
        List<String> remainingForOxygen = Arrays.asList(input);
        List<String> remainingForCo2 = Arrays.asList(input);

        for (int pos = 0; pos < input[0].length(); pos++) {
            int finalPos = pos;

            int commonForOxygen = getMostCommonValue(remainingForOxygen, pos);
            if (commonForOxygen < 0) {
                commonForOxygen = 1;
            }

            int commonForCo2 = getMostCommonValue(remainingForCo2, pos);
            if (commonForCo2 < 0) {
                commonForCo2 = 1;
            }

            int finalCommonForOxygen = commonForOxygen;
            int finalCommonForCo2 = commonForCo2;

            remainingForOxygen = remainingForOxygen.stream()
                                                   .filter(value -> value.charAt(finalPos) == ('0' + finalCommonForOxygen))
                                                   .collect(Collectors.toList());
            if (remainingForOxygen.size() == 1) {
                oxygen = parseLong(remainingForOxygen.get(0), 2);
            }

            remainingForCo2 = remainingForCo2.stream()
                                             .filter(value -> value.charAt(finalPos) != ('0' + finalCommonForCo2))
                                             .collect(Collectors.toList());
            if (remainingForCo2.size() == 1) {
                co2 = parseLong(remainingForCo2.get(0), 2);
            }

            if (oxygen > 0 && co2 > 0) {
                break;
            }
        }
        System.out.println("Oxygen: " + oxygen);
        System.out.println("CO2: " + co2);
        return oxygen * co2;
    }

    private static int getMostCommonValue(String[] input, int pos) {
        long zeroes = 0;
        long ones = 0;
        for (int i = 0; i < input.length; i++) {
            if (input[i].charAt(pos) == '0') {
                zeroes++;
            } else {
                ones++;
            }
        }
        if (zeroes == ones) {
            return -1; // Equally common
        }
        return zeroes > ones ? 0 : 1;
    }

    private static int getMostCommonValue(List<String> input, int pos) {
        return getMostCommonValue(input.toArray(new String[0]), pos);
    }

    public static void testWithExamplesForPuzzle2() {
        System.out.println("### Day 03: Examples for puzzle 2 ###");
        puzzle2Logic(SAMPLE_AS_LINE_ARRAY);
    }

    public static long doPuzzle1() {
        StringBuilder gamma = new StringBuilder();
        StringBuilder epsilon = new StringBuilder();
        for (int pos = 0; pos < INPUT_AS_LINE_ARRAY[0].length(); pos++) {
            switch (getMostCommonValue(INPUT_AS_LINE_ARRAY, pos)) {
                case 0:
                    gamma.append("0");
                    epsilon.append("1");
                    break;

                case 1:
                    gamma.append("1");
                    epsilon.append("0");
                    break;

                default:
                    throw new IllegalArgumentException("getMostCommonValue is invalid: " + getMostCommonValue(INPUT_AS_LINE_ARRAY, pos));
            }
        }
        long gammaValue = parseLong(gamma.toString(), 2);
        long epsilonValue = parseLong(epsilon.toString(), 2);
        return gammaValue * epsilonValue;
    }

    public static long doPuzzle2() {
        return puzzle2Logic(INPUT_AS_LINE_ARRAY);
    }
}
